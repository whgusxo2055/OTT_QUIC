---

# 📄 **OTT_QUIC – Software Requirements Specification (SRS)**

### **Version 3.1.0**

### **Last Updated: 2025-12-06**

---

## 🗂️ 문서 정보

| 항목    | 내용                                                                                 |
| ----- | ---------------------------------------------------------------------------------- |
| 프로젝트명 | OTT_QUIC                                                                           |
| 버전    | 3.1.0                                                                              |
| 작성일   | 2025-12-06                                                                         |
| 저장소   | [https://github.com/whgusxo2055/OTT_QUIC](https://github.com/whgusxo2055/OTT_QUIC) |
| 파일명   | SRS.md                                                                             |

---

# 1. 📘 개요

## 1.1 목적

OTT_QUIC은 학습 목적의 QUIC 기반 스트리밍 플랫폼으로, 다음을 목표로 한다:

* QUIC 전송 계층을 직접 구현하며 네트워크 프로그래밍 핵심 구조 학습
* TLS 1.3을 OpenSSL 3.2+와 연동하여 QUIC 암호화 구조 구현
* 브라우저 ↔ 서버 구간을 HTTPS/WSS로 보호
* 관리자 페이지를 통해 영상 및 사용자 관리 기능 제공

본 문서는 **버전 3.1 기준 전체 요구사항을 정의**한다.

---

## 1.2 범위

본 SRS는 아래 구성요소를 포함한다:

* 사용자 인증 및 세션 관리
* 영상 목록 및 스트리밍 재생
* QUIC 전송 계층 (스트림/패킷/재전송/혼잡 제어)
* OpenSSL 3.2+ 기반 TLS 1.3 핸드셰이크 및 key export 기능
* 관리자 UI(admin.html) 기반 영상/사용자 관리
* Docker 기반 실행 환경 및 OpenSSL 소스 빌드 요구사항

---

# 2. 🏗️ 시스템 아키텍처

## 2.1 전체 구조도

```
┌─────────────────────────────────────────────────────────┐
│                      Chrome 브라우저                     │
│  index.html / videos.html / player.html / admin.html    │
└───────────────────────────┬──────────────────────────────┘
                            │ HTTPS + WSS (TCP 8443)
                            ▼
┌─────────────────────────────────────────────────────────┐
│                    OTT_QUIC 서버 (Docker)               │
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │               HTTPS/WSS 핸들러 (TCP 8443)           │ │
│ │  • 로그인/세션 관리                                  │ │
│ │  • 영상 목록/히스토리 API                            │ │
│ │  • 관리자 API (업로드/삭제/사용자 관리)              │ │
│ └───────────────────────┬─────────────────────────────┘ │
│                         │                               │
│ ┌───────────────────────▼─────────────────────────────┐ │
│ │        QUIC + TLS 엔진 (UDP 9443, 내부 전용)        │ │
│ │  • UDP 기반 QUIC 연결/스트림                         │ │
│ │  • OpenSSL TLS 1.3 handshake                         │ │
│ │  • key export 메커니즘으로 패킷 암·복호화 키 획득   │ │
│ └───────────────────────┬─────────────────────────────┘ │
│                         │                               │
│ ┌───────────────────────▼─────────────────────────────┐ │
│ │                 스트리밍 엔진                        │ │
│ │  • 영상 청크(1MB) 분할 및 QUIC 전송                  │ │
│ │  • 시킹(seek) 처리                                   │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ ┌──────────────────┐   ┌──────────────────┐             │
│ │ SQLite DB        │   │ 동영상/썸네일 FS │             │
│ └──────────────────┘   └──────────────────┘             │
└─────────────────────────────────────────────────────────┘
```

---

## 2.2 포트 정책

| 포트       | 프로토콜 | 용도                                    |
| -------- | ---- | --------------------------------------- |
| **8443** | TCP  | HTTPS / WSS (외부 공개, Nginx TLS 종료)         |
| **8080** | TCP  | 내부 백엔드 HTTP (Nginx 업스트림, 외부 비공개)     |
| **9443** | UDP  | QUIC + TLS (내부 전용)                      |

---

# 3. ⚙️ 기능 요구사항

## 3.1 사용자 인증 (FR-AUTH)

| ID         | 요구사항                              |
| ---------- | --------------------------------- |
| FR-AUTH-01 | HTTPS 기반 로그인 페이지에서 ID/Password 입력 |
| FR-AUTH-02 | 성공 시 세션 생성 후 session_token 발급     |
| FR-AUTH-03 | 세션은 30분 후 만료                      |
| FR-AUTH-04 | 비밀번호는 bcrypt 등 안전한 해시 사용          |
| FR-AUTH-05 | 세션 토큰은 HTTPS/WSS에서만 전달            |

---

## 3.2 영상 목록 및 재생 (FR-LIST, FR-PLAY)

| ID         | 요구사항            |
| ---------- | --------------- |
| FR-LIST-01 | 영상 목록 조회 가능     |
| FR-LIST-02 | 썸네일/제목/설명/시간 표시 |
| FR-PLAY-01 | 스트리밍 재생 시작      |
| FR-PLAY-02 | 특정 시간으로 시킹 가능   |

---

## 3.3 이어보기 (FR-RESUME)

| ID           | 요구사항                |
| ------------ | ------------------- |
| FR-RESUME-01 | 10초마다 시청 위치 저장      |
| FR-RESUME-02 | 다음 재생 시 저장된 위치에서 시작 |

---

## 3.4 관리자 기능 (FR-ADMIN)

| ID          | 요구사항                          |
| ----------- | ----------------------------- |
| FR-ADMIN-01 | admin.html 접근은 관리자 계정만 가능     |
| FR-ADMIN-02 | 관리자 페이지에서 영상 업로드 가능           |
| FR-ADMIN-03 | 영상 삭제 가능                      |
| FR-ADMIN-04 | 사용자 추가/삭제 가능                  |
| FR-ADMIN-05 | 모든 관리자 API는 HTTPS + 관리자 세션 필요 |

---

## 3.5 QUIC/TLS 보안 기능 (FR-QUIC-TLS)

| ID             | 요구사항                                       |
| -------------- | ------------------------------------------ |
| FR-QUIC-TLS-01 | QUIC 엔진은 TLS 1.3(OpenSSL) 기반 핸드셰이크 수행      |
| FR-QUIC-TLS-02 | TLS 핸드셰이크 데이터는 CRYPTO 프레임으로 송수신            |
| FR-QUIC-TLS-03 | 패킷 보호 키는 OpenSSL 3.2+ key export 메커니즘으로 생성 |
| FR-QUIC-TLS-04 | 1-RTT 키로 스트리밍 데이터 암호화                      |
| FR-QUIC-TLS-05 | 핸드셰이크 실패 시 로그 후 스트림 종료                     |

---

## 3.6 HTTPS/WSS 보안 기능 (FR-HTTPS)

| ID          | 요구사항                        |
| ----------- | --------------------------- |
| FR-HTTPS-01 | 모든 클라이언트 요청은 HTTPS/WSS 사용   |
| FR-HTTPS-02 | HTTP 요청은 HTTPS로 리다이렉트 또는 차단 |
| FR-HTTPS-03 | 동일 서버 인증서를 HTTPS/WSS에 사용    |

---

# 4. 🛡️ 비기능 요구사항

## 4.1 성능 (NFR-PERF)

| ID          | 목표                    |
| ----------- | --------------------- |
| NFR-PERF-01 | 동시 5명 스트리밍 지원         |
| NFR-PERF-02 | 평균 버퍼링 지연 ≤ 1초(로컬 기준) |

---

## 4.2 보안 (NFR-SEC)

* TLS 버전 1.3만 허용
* 인증서/키 파일 최소 권한 유지
* 세션 토큰은 HTTPS/WSS 경로로만 사용
* 관리자 페이지는 role='admin' 사용자만 접근

---

## 4.3 제한 (NFR-CAP)

* 동영상 최대 2GB
* 등록 영상 10개 제한
* 사용자 최대 10명

---

# 5. 🗄️ 데이터베이스 설계

## 5.1 ERD

```
 users
 ├ id (PK)
 ├ username (UNIQUE)
 ├ nickname
 ├ password_hash
 ├ role ('user' | 'admin')
 └ created_at

 videos
 ├ id (PK)
 ├ title
 ├ description
 ├ file_path
 ├ thumbnail_path
 ├ duration
 └ upload_date

 watch_history
 ├ id (PK)
 ├ user_id (FK)
 ├ video_id (FK)
 ├ last_position
 └ updated_at

 sessions
 ├ id (PK)
 ├ user_id (FK)
 ├ token (UNIQUE)
 ├ expires_at
 └ created_at
```

---

# 6. 🔌 인터페이스 요구사항

## 6.1 HTTPS REST API

| API                   | Method | 설명       |
| --------------------- | ------ | -------- |
| /api/login            | POST   | 로그인      |
| /api/logout           | POST   | 로그아웃     |
| /api/videos           | GET    | 영상 목록 조회 |
| /api/video/:id        | GET    | 영상 상세 조회 |
| /api/admin/videos     | POST   | 영상 업로드   |
| /api/admin/videos/:id | DELETE | 영상 삭제    |
| /api/admin/users      | POST   | 사용자 추가   |
| /api/admin/users/:id  | DELETE | 사용자 삭제   |

---

## 6.2 WebSocket (WSS)

엔드포인트: **wss://server:8443/ws**

메시지 타입:

* stream_start
* stream_chunk
* save_position

---

# 7. 🛠 기술 스택

| 구분    | 기술                            |
| ----- | ----------------------------- |
| 언어    | C                             |
| QUIC  | 자체 구현                         |
| TLS   | OpenSSL 3.2+ (Docker에서 소스 빌드) |
| DB    | SQLite3                       |
| 서버    | Docker Ubuntu 22.04           |
| 클라이언트 | HTML/CSS/JavaScript           |

---

# 8. 🔒 제약사항

* 브라우저의 네이티브 QUIC은 사용하지 않음
* QUIC 포트(UDP 9443)는 외부에 공개하지 않음
* 관리자 업로드 파일 크기 제한 필요(2GB 이하)

---

# 9. 🚀 추후 개선사항

* Native QUIC(HTTP/3) 브라우저 스트리밍 지원
* 어댑티브 비트레이트 스트리밍
* 관리자 역할 세분화
* QUIC 혼잡 제어 개선

---

# 10. 📝 변경 이력

| 버전            | 변경 내용                                                             |
| ------------- | ----------------------------------------------------------------- |
| 3.0.0 → 3.1.0 | 문서 통합, 포트 분리, admin role 도입, sessions 테이블 추가, HTTPS/WSS 보안 모델 명확화 |

---
